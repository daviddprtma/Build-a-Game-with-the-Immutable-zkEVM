// eslint-disable-next-line import/no-extraneous-dependencies
import { MemoryRouterProvider } from 'next-router-mock/MemoryRouterProvider/next-13';

type GenericPromiseStub<T> = () => Promise<T>;

const genericRouterBoolPromiseStub: GenericPromiseStub<boolean> = () =>
  new Promise<boolean>(res => {
    res(true);
  });

export type MockNextRouterProps = {
  children?: any;
  pathname?: string;
  pushStub?: GenericPromiseStub<boolean>;
  replaceStub?: GenericPromiseStub<boolean>;
};

export function MockNextRouter({
  children,
  pathname = '/initial',
  pushStub = genericRouterBoolPromiseStub,
  replaceStub = genericRouterBoolPromiseStub,
}: MockNextRouterProps) {
  return (
    <MemoryRouterProvider
      async
      url={pathname}
      onPush={pushStub}
      onReplace={replaceStub}
    >
      {children}
    </MemoryRouterProvider>
  );
}
