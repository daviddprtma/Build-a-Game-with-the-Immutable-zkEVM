import { motion } from 'framer-motion';
import { ReactElement } from 'react';
import merge from 'ts-deepmerge';

import { useTheme } from '../../hooks';
import { ClearValueButtonProps } from '../../types/clickable';
import { BaseClickable } from '../Clickable';
import { Icon } from '../Icon';
import { clearValueButtonSx } from './styles';

export function ClearValueButton<
  RC extends ReactElement | undefined = undefined,
>({
  sx = {},
  className = 'clearValueButton',
  rc,
  ...props
}: ClearValueButtonProps<RC>) {
  const { base } = useTheme();
  return (
    <BaseClickable
      {...props}
      rc={
        rc || (
          <motion.button
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            transition={{
              ease: base.motion.normal.fast.jsEase,
              duration: base.motion.normal.fast.jsDuration,
            }}
          />
        )
      }
      className={className}
      sx={merge(clearValueButtonSx, sx)}
    >
      <Icon
        icon="CloseWithCircle"
        variant="bold"
        sx={{ width: 'base.icon.size.200' }}
      />
    </BaseClickable>
  );
}

ClearValueButton.displayName = 'ClearValueButton';
