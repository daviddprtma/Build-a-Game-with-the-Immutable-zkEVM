import { LooseAutocomplete, SpacingTokenPaths } from '@biom3/design-tokens';
import { ReactElement } from 'react';
import merge from 'ts-deepmerge';

import { MakeValidSxValue } from '../../types/sxProps';
import { Box, BoxWithRCAndDomProps } from '../Box';

export type GridBoxProps<RC extends ReactElement | undefined = undefined> =
  BoxWithRCAndDomProps<RC> & {
    minColumnWidth?: string;
    gap?: MakeValidSxValue<LooseAutocomplete<NonNullable<SpacingTokenPaths>>>;
  };

export function GridBox<RC extends ReactElement | undefined = undefined>({
  sx = {},
  minColumnWidth = '180px',
  gap = 'base.spacing.x4',
  ...props
}: GridBoxProps<RC>) {
  return (
    <Box
      {...props}
      sx={merge(
        {
          display: 'grid',
          gridTemplateColumns: `repeat(auto-fill, minmax(${minColumnWidth}, 1fr))`,
          gap,
          alignItems: 'start',
          width: '100%',
        },
        sx,
      )}
    />
  );
}

GridBox.displayName = 'GridBox';
